<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="google-site-verification" content="3Z72G6MvtRASAnWKvZuxBt8gRTMv1R0s1AhRePnjDTU" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Infocyteapiquery page" />
    <meta name="keywords" content="infocyte, infocyteapi, Infocyteapiquery, infocyte python, infocyte api, infocyte api query, manjesh23" />
    <meta name="author" content="manjesh23" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="./css/style.css">
    <script type='text/javascript' src='./js/script.js'></script>
    <!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script type="text/javascript">
        $(function() {
            $('#button').click(function() {
                if (!$('#iframe').length) {
                    $('#iframeHolder').html('<iframe id="iframe" src="regexmap.html" width="100%" height="500"></iframe>');
                }
            });
        });
    </script>
    <title>
        Infocyteapiquery
    </title>
</head>

<body onload=display_ct();>
    <div class="collapse" id="navbarToggleExternalContent">
        <div class="bg-dark p-4">
            <h5 class="text-muted">Designed and Maintained by:</h5>
            <span class="text-white fs-2">Manjesh N</span>
        </div>
    </div>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid justify-content-evenly">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
            <span>Author</span>
          </button>
            <div class="text-white text-start">
                <p class="fs-1">Infocyteapiquery</p>
                <p class="text-muted fs-5">Python module | Used to get API data from Infocyte Cloud Instances into the pandas DataFrame | Defaults to 90 days</p>
                <a href="https://github.com/manjesh23/infocyteapiquery" class="btn btn-outline-success">View on Github</a>
                <a href="https://pypi.org/project/infocyteapiquery" class="btn btn-outline-secondary mx-2">View on Pypi</a>
            </div>
    </nav>
    <span id='ct' class="text-primary position-absolute top-10 end-0"></span>
    <div class="tab">
        <button class="tablinks" onclick="opentab(event, 'home')">Home</button>
        <button class="tablinks" onclick="opentab(event, 'yaml')">Rules Tester</button>
        <button class="tablinks" onclick="opentab(event, 'yamlb')">Rule Builder</button>
        <button class="tablinks" onclick="opentab(event, 'logz')">Logalizer</button>

    </div>
    <div id="home" class="tabcontent">
        <h3>Home</h3>
        <p>This is our homepage.</p>
    </div>

    <div id="yaml" class="tabcontent">
        <h3>YAML Rule Tester</h3>
        <p>Test your YAML rules against Infocyte data.</p>
        <h2>Working on it</h2>
        <p class="fs-4 text-primary">YAML Rule Body: </p><textarea id="yamlInput" placeholder="YAML Rule goes here..."></textarea>
        <br>
        <p class="fs-4 text-primary">Offline Scan Data: </p><textarea id="dataInput" placeholder="Infocyte Offline Scan Data goes here..."></textarea>
        <br>
        <button type="submit" class="btn btn-secondary" onClick="regexmatch();">Test Rule</button>
        <br>
        <p id="demo"></p>

    </div>

    </div>
    <div id="yamlb" class="tabcontent three-col">
        <h3>YAML Rule Builder</h3>
        <p>YAML Rules for Humans.</p>
        <div class="col1 fs-4 text-primary">
            <label for="mandate">Mandate:</label>
            <textarea class="textbox" id="mandate" name="mandate" type="text" onkeyup="trimMe(this)"></textarea>
        </div>
        <div class="col2 fs-4 text-primary">
            <label for="logicand">AND:</label>
            <textarea class="textbox" id="logicand" name="logicand" type="text" onkeyup="trimMe(this)"></textarea>
        </div>
        <div class="col3 fs-4 text-primary">
            <label for="logicor">OR:</label>
            <textarea class="textbox" id="logicor" name="logicor" type="text" onkeyup="trimMe(this)"></textarea>
        </div>
        <button type="submit" class="btn btn-secondary" onClick="buildrule();">Build Rule</button>
        <button type="submit" class="btn btn-secondary" id="button" onClick="flowdiag();">Flow Diagram</button>
        <hr>
        <p class="fs-4 text-secondary">YAML Rule Body</p>
        <div id="build" contenteditable="true"></div>
        <iframe height=500 width="100%" frameborder=0 name="railroad"></iframe>
    </div>
    <div id="logz" class="tabcontent three-col">
        <h3>Logalizer</h3>
        <p>Analyze logs Eazy</p>
        <div class="col1">
            <input id="evlogs" hidden="hidden" type="file" class="uploadfiles" name="evlogs" onclick="evlogs();" />
            <button type="button" class="btn btn-outline-secondary" id="evcustom-button">Event Viewer Logs</button>
            <p class="fs-6 text-secondary">Get-EventLog -LogName System -Message *infocyte* | Format-Table -AutoSize | Out-File 'C:\.....\Desktop\ic.txt'</p>
        </div>
        <div class="col2">
            <input id="alogs" hidden="hidden" type="file" class="uploadfiles" name="alogs" onclick="alogs();" />
            <button type="button" class="btn btn-outline-secondary" id="acustom-button">Agent Logs</button>
            <p class="fs-6 text-secondary">C:\Program Files\Infocyte\Agent\logs</p>
        </div>
        <div class="col3">
            <input id="clogs" hidden="hidden" type="file" class="uploadfiles" name="clogs" onclick="clogs();" />
            <button type="button" class="btn btn-outline-secondary" id="ccustom-button">Controller Logs</button>
            <p class="fs-6 text-secondary">C:\Program Files\Infocyte\HUNT Controller\logs</p>
        </div>
        <span id="evcustom-text"></span>
        <span id="acustom-text"></span>
        <span id="ccustom-text"></span>
        <pre class="formated" id="results"></pre>
    </div>
    </div>
</body>
<script>
    const _0x3cb8 = ['addEventListener', 'toString', '319065VzyNVc', 'target', 'commandLine', 'long', '1046gJdBeq', 'value', 'click', 'ccustom-button', '<span\x20class=\x27other\x27>', 'replace', 'includes', 'match', 'No\x20file\x20chosen,\x20yet.', 'substring', 'params', 'en-US', '1301wvByhb', 'alogs', 'map', 'path', 'decodedPayload', 'clogs', 'spana', 'getElementById', 'remote_addr', 'name', '41aZAZaG', 'grandParentProcessName', 'change', 'evcustom-text', 'reduce', '6GdUnjv', 'hostOs', 'indexOf', 'filter', '82RfCOxk', 'raw', 'state', 'querySelector', 'results', '19NmOZpn', 'split', 'innerText', 'remote_port', '6397JasVgv', '</span>', '31585TLeJcC', 'spanb#tzonehere', '7405QOiJFf', '#results', 'innerHTML', 'toLocaleString', 'join', 'medium', '351631KaBDXW', 'context', '31PjcOrX', 'parentProcessName', 'destination_ip', 'type'];
    const _0x33f58d = _0x4cab;
    (function(_0x173944, _0x14096f) {
        const _0x38b4a0 = _0x4cab;
        while (!![]) {
            try {
                const _0x211124 = -parseInt(_0x38b4a0(0x1e0)) * -parseInt(_0x38b4a0(0x1c1)) + -parseInt(_0x38b4a0(0x1bd)) * -parseInt(_0x38b4a0(0x1ae)) + parseInt(_0x38b4a0(0x1c6)) * parseInt(_0x38b4a0(0x1ca)) + parseInt(_0x38b4a0(0x1dc)) + parseInt(_0x38b4a0(0x1d4)) + parseInt(_0x38b4a0(0x1b8)) * parseInt(_0x38b4a0(0x1ce)) + parseInt(_0x38b4a0(0x1d6)) * -parseInt(_0x38b4a0(0x1cc));
                if (_0x211124 === _0x14096f) break;
                else _0x173944['push'](_0x173944['shift']());
            } catch (_0x59d2d8) {
                _0x173944['push'](_0x173944['shift']());
            }
        }
    }(_0x3cb8, 0x3356f));
    var keywords = [_0x33f58d(0x1be), _0x33f58d(0x1d9), _0x33f58d(0x1c2), 'processName', _0x33f58d(0x1de), _0x33f58d(0x1b1), _0x33f58d(0x1d7), _0x33f58d(0x1b9), _0x33f58d(0x1b2), _0x33f58d(0x1c3), _0x33f58d(0x1b7), _0x33f58d(0x1b6), _0x33f58d(0x1d8), _0x33f58d(0x1c9), _0x33f58d(0x1ac)];
    document[_0x33f58d(0x1c4)]('#build')[_0x33f58d(0x1da)]('mouseover', function(_0x2b63ef) {
        const _0x3ceb5b = _0x33f58d;
        var _0x67d230 = '';
        str = _0x2b63ef[_0x3ceb5b(0x1dd)][_0x3ceb5b(0x1c8)], (chunks = str[_0x3ceb5b(0x1c7)](new RegExp(keywords[_0x3ceb5b(0x1b0)](_0x17cbe5 => '(' + _0x17cbe5 + ')')[_0x3ceb5b(0x1d2)]('|'), 'i'))[_0x3ceb5b(0x1c0)](Boolean), markup = chunks[_0x3ceb5b(0x1bc)]((_0xcaeb7f, _0x2867d3) => {
            const _0x8daa4c = _0x3ceb5b;
            return _0xcaeb7f += keywords[_0x8daa4c(0x1a8)](_0x2867d3) ? '<span\x20class=\x22keyword\x22>' + _0x2867d3 + _0x8daa4c(0x1cb) : _0x8daa4c(0x1a6) + _0x2867d3 + '</span>', _0xcaeb7f;
        }, '')), _0x2b63ef[_0x3ceb5b(0x1dd)][_0x3ceb5b(0x1d0)] = markup;
    });
    const evrealFileBtn = document[_0x33f58d(0x1b5)]('evlogs'),
        evcustomBtn = document['getElementById']('evcustom-button'),
        evcustomTxt = document['getElementById'](_0x33f58d(0x1bb));

    function _0x4cab(_0xe22324, _0x192651) {
        _0xe22324 = _0xe22324 - 0x1a5;
        let _0x3cb884 = _0x3cb8[_0xe22324];
        return _0x3cb884;
    }
    evcustomBtn[_0x33f58d(0x1da)](_0x33f58d(0x1e2), function() {
        evrealFileBtn['click']();
    }), evrealFileBtn['addEventListener'](_0x33f58d(0x1ba), function() {
        const _0x484fbd = _0x33f58d;
        evrealFileBtn[_0x484fbd(0x1e1)] ? evcustomTxt[_0x484fbd(0x1d0)] = evrealFileBtn['value'][_0x484fbd(0x1a9)](/[\/\\]([\w\d\s\.\-\(\)]+)$/)[0x1] : evcustomTxt['innerHTML'] = _0x484fbd(0x1aa);
    });
    const arealFileBtn = document[_0x33f58d(0x1b5)](_0x33f58d(0x1af)),
        acustomBtn = document[_0x33f58d(0x1b5)]('acustom-button'),
        acustomTxt = document['getElementById']('acustom-text');
    acustomBtn[_0x33f58d(0x1da)](_0x33f58d(0x1e2), function() {
        const _0x49ec79 = _0x33f58d;
        arealFileBtn[_0x49ec79(0x1e2)]();
    }), arealFileBtn[_0x33f58d(0x1da)]('change', function() {
        const _0x3c2fb4 = _0x33f58d;
        arealFileBtn[_0x3c2fb4(0x1e1)] ? acustomTxt[_0x3c2fb4(0x1d0)] = arealFileBtn[_0x3c2fb4(0x1e1)]['match'](/[\/\\]([\w\d\s\.\-\(\)]+)$/)[0x1] : acustomTxt['innerHTML'] = _0x3c2fb4(0x1aa);
    });
    const crealFileBtn = document[_0x33f58d(0x1b5)](_0x33f58d(0x1b3)),
        ccustomBtn = document[_0x33f58d(0x1b5)](_0x33f58d(0x1a5)),
        ccustomTxt = document[_0x33f58d(0x1b5)]('ccustom-text');
    ccustomBtn['addEventListener'](_0x33f58d(0x1e2), function() {
        const _0x2315a3 = _0x33f58d;
        crealFileBtn[_0x2315a3(0x1e2)]();
    }), crealFileBtn[_0x33f58d(0x1da)](_0x33f58d(0x1ba), function() {
        const _0x8962db = _0x33f58d;
        crealFileBtn[_0x8962db(0x1e1)] ? ccustomTxt[_0x8962db(0x1d0)] = crealFileBtn[_0x8962db(0x1e1)][_0x8962db(0x1a9)](/[\/\\]([\w\d\s\.\-\(\)]+)$/)[0x1] : ccustomTxt[_0x8962db(0x1d0)] = _0x8962db(0x1aa);
    }), $(document[_0x33f58d(0x1c4)](_0x33f58d(0x1cf)))['on']('mouseenter', _0x33f58d(0x1b4), function(_0x4640b5) {
        const _0x5f1168 = _0x33f58d;
        var _0x17de97 = $(_0x4640b5[_0x5f1168(0x1dd)])[_0x5f1168(0x1d5)][_0x5f1168(0x1c8)];
        _0x4640b5[_0x5f1168(0x1dd)][_0x5f1168(0x1d0)] = new Date(_0x17de97)[_0x5f1168(0x1db)]()[_0x5f1168(0x1a7)](/ *\([^)]*\) */g, '');
    }), $(document[_0x33f58d(0x1c4)]('#results'))['on']('mouseenter', 'spanb', function(_0x4a5c9f) {
        const _0xf32989 = _0x33f58d;
        let _0x2189f0 = document[_0xf32989(0x1b5)](_0xf32989(0x1c5), _0xf32989(0x1cd))[_0xf32989(0x1c8)]['match'](new RegExp(/tzone:[a-zA-Z/_]{0,50}/, 'gi')),
            _0x250abf = _0x2189f0[0x0][_0xf32989(0x1ab)](_0x2189f0[0x0][_0xf32989(0x1bf)](':') + 0x1);
        var _0xf39b23 = $(_0x4a5c9f[_0xf32989(0x1dd)])[_0xf32989(0x1d5)]['innerText'];
        _0x4a5c9f[_0xf32989(0x1dd)][_0xf32989(0x1d0)] = new Date(_0xf39b23)[_0xf32989(0x1d1)](_0xf32989(0x1ad), {
            'dateStyle': _0xf32989(0x1d3),
            'timeStyle': _0xf32989(0x1df),
            'timeZone': '' + _0x250abf
        });
    });
</script>

</html>