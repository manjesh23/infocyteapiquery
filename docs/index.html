<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="google-site-verification" content="3Z72G6MvtRASAnWKvZuxBt8gRTMv1R0s1AhRePnjDTU" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Infocyteapiquery page" />
    <meta name="keywords" content="infocyte, infocyteapi, Infocyteapiquery, infocyte python, infocyte api, infocyte api query, manjesh23" />
    <meta name="author" content="manjesh23" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="./css/style.css">
    <script type='text/javascript' src='./js/script.js'></script>
    <!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script type="text/javascript">
        $(function() {
            $('#button').click(function() {
                if (!$('#iframe').length) {
                    $('#iframeHolder').html('<iframe id="iframe" src="regexmap.html" width="100%" height="500"></iframe>');
                }
            });
        });
    </script>
    <title>
        Infocyteapiquery
    </title>
</head>

<body onload=display_ct();>
    <div class="collapse" id="navbarToggleExternalContent">
        <div class="bg-dark p-4">
            <h5 class="text-muted">Designed and Maintained by:</h5>
            <span class="text-white fs-2">Manjesh N</span>
        </div>
    </div>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid justify-content-evenly">
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
            <span>Author</span>
          </button>
            <div class="text-white text-start">
                <p class="fs-1">Infocyteapiquery</p>
                <p class="text-muted fs-5">Python module | Used to get API data from Infocyte Cloud Instances into the pandas DataFrame | Defaults to 90 days</p>
                <a href="https://github.com/manjesh23/infocyteapiquery" class="btn btn-outline-success">View on Github</a>
                <a href="https://pypi.org/project/infocyteapiquery" class="btn btn-outline-secondary mx-2">View on Pypi</a>
            </div>
    </nav>
    <span id='ct' class="text-primary position-absolute top-10 end-0"></span>
    <div class="tab">
        <button class="tablinks" onclick="opentab(event, 'home')">Home</button>
        <button class="tablinks" onclick="opentab(event, 'yaml')">Rules Tester</button>
        <button class="tablinks" onclick="opentab(event, 'yamlb')">Rule Builder</button>
        <button class="tablinks" onclick="opentab(event, 'logz')">Logalizer</button>

    </div>
    <div id="home" class="tabcontent">
        <h3>Home</h3>
        <p>This is our homepage.</p>
    </div>

    <div id="yaml" class="tabcontent">
        <h3>YAML Rule Tester</h3>
        <p>Test your YAML rules against Infocyte data.</p>
        <h2>Working on it</h2>
        <p class="fs-4 text-primary">YAML Rule Body: </p><textarea id="yamlInput" placeholder="YAML Rule goes here..."></textarea>
        <br>
        <p class="fs-4 text-primary">Offline Scan Data: </p><textarea id="dataInput" placeholder="Infocyte Offline Scan Data goes here..."></textarea>
        <br>
        <button type="submit" class="btn btn-secondary" onClick="regexmatch();">Test Rule</button>
        <br>
        <p id="demo"></p>

    </div>

    </div>
    <div id="yamlb" class="tabcontent three-col">
        <h3>YAML Rule Builder</h3>
        <p>YAML Rules for Humans.</p>
        <div class="col1 fs-4 text-primary">
            <label for="mandate">Mandate:</label>
            <textarea class="textbox" id="mandate" name="mandate" type="text" onkeyup="trimMe(this)"></textarea>
        </div>
        <div class="col2 fs-4 text-primary">
            <label for="logicand">AND:</label>
            <textarea class="textbox" id="logicand" name="logicand" type="text" onkeyup="trimMe(this)"></textarea>
        </div>
        <div class="col3 fs-4 text-primary">
            <label for="logicor">OR:</label>
            <textarea class="textbox" id="logicor" name="logicor" type="text" onkeyup="trimMe(this)"></textarea>
        </div>
        <button type="submit" class="btn btn-secondary" onClick="buildrule();">Build Rule</button>
        <button type="submit" class="btn btn-secondary" id="button" onClick="flowdiag();">Flow Diagram</button>
        <hr>
        <p class="fs-4 text-secondary">YAML Rule Body</p>
        <div id="build" contenteditable="true"></div>
        <iframe height=500 width="100%" frameborder=0 name="railroad"></iframe>
    </div>
    <div id="logz" class="tabcontent three-col">
        <h3>Logalizer</h3>
        <p>Analyze logs Eazy</p>
        <div class="col1">
            <input id="evlogs" hidden="hidden" type="file" class="uploadfiles" name="evlogs" onclick="evlogs();" />
            <button type="button" class="btn btn-outline-secondary" id="evcustom-button">Event Viewer Logs</button>
            <p class="fs-6 text-secondary">Get-EventLog -LogName System -Message *infocyte* | Format-Table -AutoSize | Out-File 'C:\.....\Desktop\ic.txt'</p>
        </div>
        <div class="col2">
            <input id="alogs" hidden="hidden" type="file" class="uploadfiles" name="alogs" onclick="alogs();" />
            <button type="button" class="btn btn-outline-secondary" id="acustom-button">Agent Logs</button>
            <p class="fs-6 text-secondary">C:\Program Files\Infocyte\Agent\logs</p>
        </div>
        <div class="col3">
            <input id="clogs" hidden="hidden" type="file" class="uploadfiles" name="clogs" onclick="clogs();" />
            <button type="button" class="btn btn-outline-secondary" id="ccustom-button">Controller Logs</button>
            <p class="fs-6 text-secondary">C:\Program Files\Infocyte\HUNT Controller\logs</p>
        </div>
        <span id="evcustom-text"></span>
        <span id="acustom-text"></span>
        <span id="ccustom-text"></span>
        <pre class="formated" id="results"></pre>
    </div>
    </div>
</body>
<script>
    const _0x3df6 = ['type', 'toLocaleString', 'target', '</span>', 'value', 'long', 'innerText', 'remote_addr', 'mouseover', 'reduce', 'hostOs', 'addEventListener', 'change', 'getElementById', 'acustom-button', 'commandLine', '#results', 'spanb', '124367Depvqx', '199077utJQwK', 'mouseenter', 'indexOf', 'decodedPayload', 'spana', 'spanb#tzonehere', 'ccustom-text', 'evlogs', 'raw', 'context', 'filter', '2AvNaQX', 'toString', 'destination_ip', 'innerHTML', 'medium', '<span\x20class=\x27other\x27>', 'map', '158894QnYdjW', 'querySelector', 'match', '31081AdiDqt', 'en-US', 'click', 'remote_port', '12zaebii', 'processName', 'results', '<span\x20class=\x22keyword\x22>', '373520pPUuvo', '2477fzpXEw', '198CRBjzZ', '#build', 'evcustom-button', 'substring', 'No\x20file\x20chosen,\x20yet.', 'alogs', 'state', 'name', 'clogs', '129583peeLgG'];
    const _0x123e31 = _0x4b59;
    (function(_0x22c56c, _0x1c5ca5) {
        const _0x207866 = _0x4b59;
        while (!![]) {
            try {
                const _0x47c657 = -parseInt(_0x207866(0x126)) * parseInt(_0x207866(0x122)) + parseInt(_0x207866(0x10d)) + parseInt(_0x207866(0xef)) * -parseInt(_0x207866(0xf0)) + parseInt(_0x207866(0xf9)) + parseInt(_0x207866(0x11f)) + parseInt(_0x207866(0x12a)) + -parseInt(_0x207866(0x10c)) * -parseInt(_0x207866(0x118));
                if (_0x47c657 === _0x1c5ca5) break;
                else _0x22c56c['push'](_0x22c56c['shift']());
            } catch (_0x331ec8) {
                _0x22c56c['push'](_0x22c56c['shift']());
            }
        }
    }(_0x3df6, 0x3c276));
    var keywords = [_0x123e31(0x104), _0x123e31(0xfa), _0x123e31(0x115), _0x123e31(0x127), _0x123e31(0x109), 'path', 'parentProcessName', 'grandParentProcessName', _0x123e31(0x110), _0x123e31(0xf6), _0x123e31(0xf7), _0x123e31(0x101), _0x123e31(0x11a), _0x123e31(0x125), 'params'];

    function _0x4b59(_0x5d6302, _0x251f88) {
        _0x5d6302 = _0x5d6302 - 0xef;
        let _0x3df641 = _0x3df6[_0x5d6302];
        return _0x3df641;
    }
    document['querySelector'](_0x123e31(0xf1))[_0x123e31(0x105)](_0x123e31(0x102), function(_0x3675a4) {
        const _0x368016 = _0x123e31;
        var _0x52a8c5 = '';
        str = _0x3675a4['target']['innerText'], (chunks = str['split'](new RegExp(keywords[_0x368016(0x11e)](_0xc0420b => '(' + _0xc0420b + ')')['join']('|'), 'i'))[_0x368016(0x117)](Boolean), markup = chunks[_0x368016(0x103)]((_0x5c8633, _0x21fc63) => {
            const _0x354fb5 = _0x368016;
            return _0x5c8633 += keywords['includes'](_0x21fc63) ? _0x354fb5(0x129) + _0x21fc63 + _0x354fb5(0xfd) : _0x354fb5(0x11d) + _0x21fc63 + _0x354fb5(0xfd), _0x5c8633;
        }, '')), _0x3675a4[_0x368016(0xfc)]['innerHTML'] = markup;
    });
    const evrealFileBtn = document[_0x123e31(0x107)](_0x123e31(0x114)),
        evcustomBtn = document[_0x123e31(0x107)](_0x123e31(0xf2)),
        evcustomTxt = document[_0x123e31(0x107)]('evcustom-text');
    evcustomBtn[_0x123e31(0x105)]('click', function() {
        const _0x12576b = _0x123e31;
        evrealFileBtn[_0x12576b(0x124)]();
    }), evrealFileBtn[_0x123e31(0x105)](_0x123e31(0x106), function() {
        const _0xe8b973 = _0x123e31;
        evrealFileBtn['value'] ? evcustomTxt[_0xe8b973(0x11b)] = evrealFileBtn[_0xe8b973(0xfe)][_0xe8b973(0x121)](/[\/\\]([\w\d\s\.\-\(\)]+)$/)[0x1] : evcustomTxt[_0xe8b973(0x11b)] = 'No\x20file\x20chosen,\x20yet.';
    });
    const arealFileBtn = document[_0x123e31(0x107)](_0x123e31(0xf5)),
        acustomBtn = document['getElementById'](_0x123e31(0x108)),
        acustomTxt = document[_0x123e31(0x107)]('acustom-text');
    acustomBtn['addEventListener'](_0x123e31(0x124), function() {
        const _0x3e9ea7 = _0x123e31;
        arealFileBtn[_0x3e9ea7(0x124)]();
    }), arealFileBtn[_0x123e31(0x105)](_0x123e31(0x106), function() {
        const _0x47e6cd = _0x123e31;
        arealFileBtn[_0x47e6cd(0xfe)] ? acustomTxt['innerHTML'] = arealFileBtn[_0x47e6cd(0xfe)]['match'](/[\/\\]([\w\d\s\.\-\(\)]+)$/)[0x1] : acustomTxt[_0x47e6cd(0x11b)] = 'No\x20file\x20chosen,\x20yet.';
    });
    const crealFileBtn = document[_0x123e31(0x107)](_0x123e31(0xf8)),
        ccustomBtn = document[_0x123e31(0x107)]('ccustom-button'),
        ccustomTxt = document[_0x123e31(0x107)](_0x123e31(0x113));
    ccustomBtn[_0x123e31(0x105)](_0x123e31(0x124), function() {
        const _0x4d88c = _0x123e31;
        crealFileBtn[_0x4d88c(0x124)]();
    }), crealFileBtn['addEventListener'](_0x123e31(0x106), function() {
        const _0x4c5354 = _0x123e31;
        crealFileBtn['value'] ? ccustomTxt[_0x4c5354(0x11b)] = crealFileBtn[_0x4c5354(0xfe)][_0x4c5354(0x121)](/[\/\\]([\w\d\s\.\-\(\)]+)$/)[0x1] : ccustomTxt[_0x4c5354(0x11b)] = _0x4c5354(0xf4);
    }), $(document[_0x123e31(0x120)](_0x123e31(0x10a)))['on']('mouseenter', _0x123e31(0x111), function(_0x493d97) {
        const _0x232617 = _0x123e31;
        var _0x49ec63 = $(_0x493d97['target'])[_0x232617(0x116)][_0x232617(0x100)];
        _0x493d97[_0x232617(0xfc)][_0x232617(0x11b)] = new Date(_0x49ec63)[_0x232617(0x119)]()['replace'](/ *\([^)]*\) */g, '');
    }), $(document['querySelector'](_0x123e31(0x10a)))['on'](_0x123e31(0x10e), _0x123e31(0x10b), function(_0x35b8b6) {
        const _0x2c2113 = _0x123e31;
        let _0x1ecd1f = document[_0x2c2113(0x107)](_0x2c2113(0x128), _0x2c2113(0x112))[_0x2c2113(0x100)]['match'](new RegExp(/tzone:[a-zA-Z/_]{0,50}/, 'gi')),
            _0x191a6c = _0x1ecd1f[0x0][_0x2c2113(0xf3)](_0x1ecd1f[0x0][_0x2c2113(0x10f)](':') + 0x1);
        var _0x488fd7 = $(_0x35b8b6[_0x2c2113(0xfc)])[_0x2c2113(0x116)]['innerText'];
        _0x35b8b6[_0x2c2113(0xfc)][_0x2c2113(0x11b)] = new Date(_0x488fd7)[_0x2c2113(0xfb)](_0x2c2113(0x123), {
            'dateStyle': _0x2c2113(0x11c),
            'timeStyle': _0x2c2113(0xff),
            'timeZone': '' + _0x191a6c
        });
    });
</script>

</html>