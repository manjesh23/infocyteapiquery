function display_c() { mytime = setTimeout("display_ct()", 1e3) }

function display_ct() { var e = new Date;
    document.getElementById("ct").innerHTML = e, display_c() }

function opentab(e, s) { var n, a, r; for (a = document.getElementsByClassName("tabcontent"), n = 0; n < a.length; n++) a[n].style.display = "none"; for (r = document.getElementsByClassName("tablinks"), n = 0; n < r.length; n++) r[n].className = r[n].className.replace(" active", "");
    document.getElementById(s).style.display = "block", e.currentTarget.className += " active" }

function flowdiag() { document.getElementsByName("railroad")[0].src = "regexmap.html", window.scrollBy(0, document.body.scrollHeight || document.documentElement.scrollHeight) }

function regexmatch() { var e = document.getElementById("yamlInput").value; if (e.replaceAll(/\n|\s/g, "").includes("hostOs")) var s = e.slice(e.indexOf("&&") + 3).replaceAll(/\n|\s/g, ""); var n = s.split(/\|\|/);
    console.log(n); var a = "",
        r = n[0].split(/&&/); if (n.length > 1)
        for (var l = 1; l < n.length; l++) { if (n[l].includes("((")) { console.log("------\x3e 1st if");
                a = n[0].split(/&&/).shift().concat(n[1]) } if (n[1].includes("))")) { console.log("------\x3e 2nd if");
                a = n[0].split("&&").slice(0, -1).concat(n[1]) } else { console.log("------\x3e 3rd if");
                a = n[0].split(/\(\(/).slice(0, -1).concat(n[1]) } } else { console.log("------\x3e not if");
            a = "" }
    console.log("And: " + r), console.log("Or: " + a) }

function trimMe(e) { e.value = e.value.replace(/\s\s|iregex\(\"|\"\)|iregex\(\'|\'\)/gi, " ").replace(/\s==\s|\":\"|\":\s\"/g, " = ").replace(/\"|,$/g, "").replace(/\(\n/g, "(").replace(/\n\)/g, ")") }

function buildrule() { var e = document.getElementById("mandate").value.replaceAll(/\n|,/g, " && ").replace(/=/g, ' == iregex("'),
        s = document.getElementById("logicand").value.replaceAll(/\n|,/g, " && ").replace(/=/g, ' == iregex("'),
        n = document.getElementById("logicor").value.replaceAll(/\n|,/g, " && ").replace(/=/g, ' == iregex("'),
        a = e.replaceAll(/\s&&\s/g, '") && ').replaceAll(/\s\|\|\s/g, '") || '),
        r = s.replaceAll(/\s&&\s/g, '") && ').replaceAll(/\s\|\|\s/g, '") || '),
        l = n.replaceAll(/\s&&\s/g, '") && ').replaceAll(/\s\|\|\s/g, '") || '); if ("" == e) var t = "Mandate field is Must";
    else if ("" == s && "" == n) t = a + '")';
    else if ("" == n) t = a + '") && ' + r + '")';
    else if ("" == s) t = a + '") || ' + l + '")';
    else t = a + '") && ' + r + '") || ' + l + '")'; var o = t.replaceAll(/\)\"\)/g, '"))').replaceAll(/\)\"\)\)/g, '")))').replaceAll(/\)\"\)\)\)/g, '"))))').replaceAll(/\b\s+\"|\"\s\b/g, '"').replaceAll(/!\s==/g, " != ").replaceAll(/\"\s|\s\"/g, '"').replaceAll(/\./g, "\\.").replaceAll(/\s&&\"\)/g, "").replaceAll(/iregex\(\"null\"\)/g, "null");
    document.getElementById("build").innerHTML = o }

function evlogs() { let e = document.querySelector("#evlogs");
    e.addEventListener("change", () => { let s = e.files; if (0 == s.length) return; const n = s[0]; if (Math.round(n.size / 1048576) < 10) { let e = new FileReader;
            e.readAsText(n), e.onload = (e => { var s = e.target.result; if (s.includes("InstanceID")) { var n = { "A service was installed in the system": '<span class="logsuccess">A service was installed in the system</span>', "The Infocyte HUNT Agent service is marked as an interactive service.": '<span class="logwarning">The Infocyte HUNT Agent service is marked as an interactive service</span>', "The Infocyte HUNT Agent service terminated unexpectedly.": '<span class="logdanger">The Infocyte HUNT Agent service terminated unexpectedly.</span>' }; let e = Object.keys(n); var a = JSON.stringify(e).replace(/,/g, "|").replace(/\[|\]|\"/g, ""),
                        r = new RegExp(a, "gi");
                    finalevlogs = s.replace(r, e => n[e]), document.getElementById("results").innerHTML = finalevlogs } else alert("Please upload Event Viewer logs"), window.location.reload() }), e.onerror = (e => alert(e.target.error.name)) } else alert("Keeping browser health in mind, file upload size is restricted to 10Meg"), window.location.reload() }) }

function alogs() { let e = document.querySelector("#alogs");
    e.addEventListener("change", () => { let s = e.files; if (0 == s.length) return; const n = s[0]; if (Math.round(n.size / 1048576) < 10) { let e = new FileReader;
            e.readAsText(n), e.onload = (e => { var s = e.target.result.replace(/,/g, "").split(/\r\n|\n/).join(",").replace(/,/g, "<br>"); if (s.includes("[agent::")) { var n = { "Agent has started": '<span class="logsuccess loginfoh">Agent has started</span>', "Starting as windows service": '<span class="logsuccess loginfoh">Starting as windows service</span>', "Results sent scan is complete": '<span class="logsuccess">Results sent scan is complete</span>', "Cannot execute jobs: Unable to post data: error sending request for url": '<span class="logdanger">Cannot execute jobs: Unable to post data: error sending request for url</span>', "Service stop signal received.": '<span class="logdanger">Service stop signal received.</span>', "Cannot save RTS data: unable to open database file": '<span class="logdanger">Cannot save RTS data: unable to open database file</span>', "Received stop signal from service controller": '<span class="logdanger">Received stop signal from service controller</span>', "error notifying wait possible future leak": '<span class="logdanger">error notifying wait possible future leak</span>', "Unable to put data: error sending request for url": '<span class="logdanger">Unable to put data: error sending request for url</span>', "unable to open database file": '<span class="logdanger">unable to open database file</span>', "Cannot finish fetching user accounts:": '<span class="logdanger">Cannot finish fetching user accounts:</span>', "Error communicating with API: Unable to post data: error sending request for url": '<span class="logdanger">Error communicating with API: Unable to post data: error sending request for url</span>', "os error 10051": '<span class="oserror10051 loginfoh">os error 10051</span>', "os error 10060": '<span class="oserror10060 loginfoh">os error 10060</span>', "os error 10054": '<span class="oserror10054 loginfoh">os error 10054</span>', "os error 10061": '<span class="oserror10061 loginfoh">os error 10061</span>', "os error 1450": '<span class="oserror1450 loginfoh">os error 1450</span>', "Enabling RTS": '<span class="logwarning">Enabling RTS</span>', "RTS Enabled": '<span class="logwarning">RTS Enabled</span>', "Notifying service controller that HUNT Agent is shutting down": '<span class="logwarning">Notifying service controller that HUNT Agent is shutting down</span>', "Enumerating running processes": '<span class="logprimary">Enumerating running processes</span>', "Enumerating drivers": '<span class="logprimary">Enumerating drivers</span>', "Enumerating autostart locations": '<span class="logprimary">Enumerating autostart locations</span>', "Enumerating users": '<span class="logprimary">Enumerating users</span>', "Run keys": '<span class="logprimary">Run keys</span>', AppInit_DLLs: '<span class="logprimary">AppInit_DLLs</span>', "WMI Persistence": '<span class="logprimary">WMI Persistence</span>', Services: '<span class="logprimary">Services</span>', "Accessibility features": '<span class="logprimary">Accessibility features</span>', Files: '<span class="logprimary">Files</span>', "Collecting important events": '<span class="logprimary">Collecting important events</span>', "Getting installed application list": '<span class="logprimary">Getting installed application list</span>' }; let e = Object.keys(n); var a = JSON.stringify(e).replace(/,/g, "|").replace(/\[|\]|\"/g, ""),
                        r = new RegExp(a, "gi");
                    finalalogs = s.replace(r, e => n[e]), finalalogs.includes("tzone:") ? (finalalogs = finalalogs.replace(/tzone:[a-zA-Z\/_]{0,50}/g, '<spanb id="tzonehere">$&</spanb>'), document.getElementById("results").innerHTML = finalalogs.replace(/\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\.\d{1,12}\sUTC/g, '<spanb id="tzonehere">$&</spanb>')) : document.getElementById("results").innerHTML = finalalogs.replace(/\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}\.\d{1,12}\sUTC/g, '<spana id="tzoneconvert">$&</spana>') } else alert("Please upload Agent logs"), window.location.reload() }), e.onerror = (e => alert(e.target.error.name)) } else alert("Keeping browser health in mind, file upload size is restricted to 10Meg"), window.location.reload() }) }

function clogs() { let e = document.querySelector("#clogs");
    e.addEventListener("change", () => { let s = e.files; if (0 == s.length) return; const n = s[0]; if (Math.round(n.size / 1048576) < 10) { let e = new FileReader;
            e.readAsText(n), e.onload = (e => { var s = e.target.result; if (s.includes("Discovery:") || s.includes("PSRemoting/WinRM") || s.includes("ing Subscribers") || s.includes("[Error]")) { var n = { "Starting Subscribers": '<span class="logsuccess">Starting Subscribers</span>', "Access Check: SUCCEEDED!": '<span class="logsuccess">Access Check: SUCCEEDED!</span>', "Jobs loaded successfully": '<span class="logsuccess">Jobs loaded successfully</span>', "Target is live and accessible": '<span class="logsuccess">Target is live and accessible</span>', "Target is live": '<span class="logsuccess">Target is live</span>', "Connection to Infocyte API restored!": '<span class="logwarning">Connection to Infocyte API restored!</span>', "Heartbeat Rejected: Server responded with code Unauthorized:": '<span class="logdanger">Heartbeat Rejected: Server responded with code Unauthorized:</span>', "No Response to Heartbeat: An error occurred while sending the request": '<span class="logdanger">No Response to Heartbeat: An error occurred while sending the request</span>', "Access Check FAILED.": '<span class="logdanger">Access Check FAILED.</span>', "Access is denied.": '<span class="logdanger">Access is denied.</span>', "Unable to connect to the remote server": '<span class="logdanger">Unable to connect to the remote server</span>', "Host may not exist": '<span class="logdanger">Host may not exist</span>', "Target did not respond to any probes but was registered in DNS": '<span class="logdanger">Target did not respond to any probes but was registered in DNS</span>', "Requested registry access is not allowed.": '<span class="logdanger">Requested registry access is not allowed.</span>', "No such host is known": '<span class="logdanger">No such host is known</span>', "The network path was not found": '<span class="logdanger">The network path was not found</span>', "Discovery: Target did not respond to any probes and failed DNS resolution. Target MAY NOT EXIST on this network": '<span class="logdanger">Discovery: Target did not respond to any probes and failed DNS resolution. Target MAY NOT EXIST on this network</span>', "An error occurred while sending the request.. The request failed due to an underlying issue such as network connectivity or DNS failure": '<span class="logdanger">An error occurred while sending the request.. The request failed due to an underlying issue such as network connectivity or DNS failure</span>', INACCESSIBLE: '<span class="logdanger">INACCESSIBLE</span>', "Access denied": '<span class="logdanger">Access denied</span>', "Permission denied": '<span class="logdanger">Permission denied</span>', "Stopping Subscribers": '<span class="logdanger">Stopping Subscribers</span>', "0x800706BA": '<span><a class="logdanger" href="https://support.infocyte.com/hc/en-us/articles/115000986908-Troubleshooting-WMI-RPC-Windows-" target="_blank">0x800706BA</a></span>', "Successfully EXECUTED c:\\windows\\temp\\infocyte.exe": '<span class="logprimary">Successfully EXECUTED c:\\windows\\temp\\infocyte.exe</span>' }; let e = Object.keys(n); var a = JSON.stringify(e).replace(/,/g, "|").replace(/\[|\]|\"/g, ""),
                        r = new RegExp(a, "gi");
                    finalclogs = s.replace(r, e => n[e]), document.getElementById("results").innerHTML = finalclogs } else alert("Please upload Controller logs"), window.location.reload() }), e.onerror = (e => alert(e.target.error.name)) } else alert("Keeping browser health in mind, file upload size is restricted to 10Meg"), window.location.reload() }) }